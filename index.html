<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive 3D simulation of Uranus and its moons with advanced physics">
    <title>Uranus System - Advanced Physics Simulation</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚õ¢</text></svg>">
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            background: #000;
            color: #fff;
            user-select: none;
        }

        /* Canvas Container */
        #canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Loading Screen */
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #4FD0E7;
            text-align: center;
            pointer-events: none;
            z-index: 1000;
        }

        .spinner {
            border: 3px solid rgba(79, 208, 231, 0.3);
            border-top: 3px solid #4FD0E7;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 200px;
            height: 4px;
            background: rgba(79, 208, 231, 0.2);
            border-radius: 2px;
            margin: 20px auto;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4FD0E7, #ff6b9d);
            width: 0%;
            animation: loadProgress 3s ease-out forwards;
        }

        @keyframes loadProgress {
            to { width: 100%; }
        }

        /* UI Panels */
        .ui-panel {
            position: absolute;
            background: rgba(0, 20, 40, 0.9);
            border-radius: 10px;
            border: 1px solid rgba(79, 208, 231, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            z-index: 200;
        }

        .ui-panel.minimized {
            overflow: hidden;
        }

        .panel-header {
            padding: 10px 15px;
            cursor: move;
            background: rgba(79, 208, 231, 0.1);
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(79, 208, 231, 0.2);
        }

        .panel-header h1, .panel-header h3 {
            color: #4FD0E7;
            margin: 0;
            text-shadow: 0 0 10px rgba(79, 208, 231, 0.5);
            pointer-events: none;
        }

        .panel-btn {
            width: 20px;
            height: 20px;
            border: none;
            background: rgba(79, 208, 231, 0.2);
            color: #4FD0E7;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s;
        }

        .panel-btn:hover {
            background: rgba(79, 208, 231, 0.4);
            transform: scale(1.1);
        }

        .panel-content {
            padding: 15px;
            max-height: 500px;
            overflow-y: auto;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .minimized .panel-content {
            max-height: 0;
            padding: 0 15px;
            opacity: 0;
        }

        /* Info Panel */
        #info-panel {
            top: 10px;
            left: 10px;
            width: 300px;
        }

        #info-panel h1 {
            font-size: 20px;
        }

        #info-panel h2 {
            color: #6FE5F5;
            font-size: 14px;
            margin-top: 15px;
            margin-bottom: 5px;
            border-bottom: 1px solid rgba(79, 208, 231, 0.3);
            padding-bottom: 3px;
        }

        #info-panel p {
            font-size: 12px;
            line-height: 1.4;
            color: #b0d0e0;
            margin: 3px 0;
        }

        /* Controls Panel */
        #controls-panel {
            bottom: 10px;
            left: 10px;
            width: 320px;
        }

        .control-group {
            margin: 10px 0;
        }

        .control-group label {
            display: inline-block;
            width: 120px;
            font-size: 12px;
            color: #b0d0e0;
        }

        .control-group input[type="range"] {
            width: 150px;
            vertical-align: middle;
        }

        .control-group input[type="checkbox"] {
            margin-left: 5px;
        }

        .control-group span {
            color: #6FE5F5;
            font-size: 11px;
            margin-left: 5px;
        }

        .control-button {
            background: linear-gradient(135deg, #3FA0B5, #4FD0E7);
            border: none;
            color: white;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .control-button:hover {
            background: linear-gradient(135deg, #4FD0E7, #6FE5F5);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 208, 231, 0.3);
        }

        /* Stats Panel */
        #stats-panel {
            top: 10px;
            right: 10px;
            width: 200px;
        }

        #stats-panel .panel-content {
            font-size: 12px;
            color: #6FE5F5;
        }

        #stats-panel .stat-line {
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
        }

        /* Coordinates Panel */
        #coordinates-panel {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 20, 40, 0.9);
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            color: #6FE5F5;
            border: 1px solid rgba(79, 208, 231, 0.3);
            backdrop-filter: blur(10px);
        }

        #coordinates-panel div {
            margin: 2px 0;
        }

        /* Quick Toggle Buttons */
        .quick-toggle {
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            background: rgba(0, 20, 40, 0.8);
            border-radius: 5px;
            padding: 5px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            border: 1px solid rgba(79, 208, 231, 0.3);
            z-index: 100;
        }

        .quick-toggle button {
            width: 30px;
            height: 30px;
            border: none;
            background: rgba(79, 208, 231, 0.2);
            color: #4FD0E7;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }

        .quick-toggle button:hover {
            background: rgba(79, 208, 231, 0.4);
        }

        .quick-toggle button.active {
            background: rgba(79, 208, 231, 0.6);
            color: white;
        }

        /* Help Button */
        #help-button {
            position: absolute;
            bottom: 60px;
            right: 10px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3FA0B5, #4FD0E7);
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }

        #help-button:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 20px rgba(79, 208, 231, 0.5);
        }

        /* Moon Info */
        #moon-info {
            position: absolute;
            bottom: 100px;
            right: 10px;
            background: rgba(0, 20, 40, 0.95);
            padding: 10px;
            border-radius: 5px;
            font-size: 11px;
            max-width: 200px;
            backdrop-filter: blur(10px);
            display: none;
            border: 1px solid rgba(79, 208, 231, 0.3);
            pointer-events: none;
        }

        #moon-info.visible {
            display: block;
        }

        #moon-info h3 {
            color: #4FD0E7;
            margin: 0 0 5px 0;
        }

        /* Message System */
        .message {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(79, 208, 231, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            z-index: 1500;
            font-size: 14px;
            backdrop-filter: blur(10px);
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .ui-panel {
                width: 280px !important;
            }
            
            #controls-panel {
                width: 300px !important;
            }
            
            #stats-panel {
                width: 180px !important;
            }
            
            .control-group input[type="range"] {
                width: 120px;
            }
        }
    </style>
</head>
<body>
    <!-- Main Canvas Container -->
    <div id="canvas-container"></div>
    
    <!-- Loading Screen -->
    <div id="loading">
        <div class="loading-content">
            <div>üåå Initializing Uranus System...</div>
            <div class="spinner"></div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <div style="font-size: 12px; margin-top: 10px; opacity: 0.7;">
                Self-contained simulation - no external dependencies
            </div>
        </div>
    </div>
    
    <!-- Information Panel -->
    <div id="info-panel" class="ui-panel minimized">
        <div class="panel-header">
            <div class="panel-title">
                <h1>‚õ¢ URANUS</h1>
            </div>
            <div class="panel-controls">
                <button class="panel-btn minimize-btn">‚àí</button>
            </div>
        </div>
        <div class="panel-content">
            <p><strong>The Tilted Ice Giant</strong></p>
            
            <h2>Physical Properties</h2>
            <p>Radius: 25,559 km (4√ó Earth)</p>
            <p>Mass: 14.5√ó Earth (8.681√ó10¬≤‚Åµ kg)</p>
            <p>Rotation: 17.24 hours (retrograde)</p>
            <p>Axial Tilt: 97.77¬∞ (sideways!)</p>
            <p>Orbital Period: 84 Earth years</p>
            <p>Gravity: 8.87 m/s¬≤ (0.9√ó Earth)</p>
            
            <h2>Atmosphere</h2>
            <p>82.5% Hydrogen, 15.2% Helium</p>
            <p>2.3% Methane (creates blue color)</p>
            <p>Temperature: -224¬∞C (coldest planet)</p>
            <p>Wind speeds: Up to 900 km/h</p>
            
            <h2>Ring System</h2>
            <p>‚Ä¢ 13 rings discovered in 1977</p>
            <p>‚Ä¢ Œµ (Epsilon) ring: brightest and densest</p>
            <p>‚Ä¢ Extremely dark (2-5% reflectivity)</p>
            <p>‚Ä¢ Particles: 20cm to 20m diameter</p>
            <p>‚Ä¢ Shepherd moons: Cordelia & Ophelia</p>
            
            <h2>Moon System</h2>
            <p><strong>27 Known Moons:</strong></p>
            <p>‚Ä¢ 5 Major: Miranda, Ariel, Umbriel, Titania, Oberon</p>
            <p>‚Ä¢ 13 Inner: Including Puck, Cordelia, Ophelia</p>
            <p>‚Ä¢ 9 Irregular: Retrograde & distant orbits</p>
            <p>All major moons are tidally locked</p>
            
            <h2>Unique Features</h2>
            <p>‚Ä¢ Only planet rolling on its side</p>
            <p>‚Ä¢ 42-year polar seasons</p>
            <p>‚Ä¢ Magnetosphere offset by 1/3 radius</p>
            <p>‚Ä¢ Magnetic field tilted 58.6¬∞ from axis</p>
            <p>‚Ä¢ Possible subsurface oceans on large moons</p>
            
            <h2>Exploration</h2>
            <p>‚Ä¢ Discovered: 1781 by William Herschel</p>
            <p>‚Ä¢ Visited: Voyager 2 (1986)</p>
            <p>‚Ä¢ Future: Proposed orbiter missions</p>
        </div>
    </div>
    
    <!-- Controls Panel -->
    <div id="controls-panel" class="ui-panel minimized">
        <div class="panel-header">
            <div class="panel-title">
                <h3>‚öô Controls</h3>
            </div>
            <div class="panel-controls">
                <button class="panel-btn minimize-btn">‚àí</button>
            </div>
        </div>
        <div class="panel-content">
            <div class="control-group">
                <label>Time Speed:</label>
                <input type="range" id="timeSpeed" min="-2" max="3" value="0" step="0.1">
                <span id="timeSpeedValue">1 hour/sec</span>
            </div>
            
            <div class="control-group">
                <button class="control-button" id="pauseBtn">‚è∏ Pause</button>
                <button class="control-button" id="resetBtn">‚ü≤ Reset View</button>
            </div>
            
            <div class="control-group">
                <label>
                    <input type="checkbox" id="showRings" checked> Show Rings
                </label>
            </div>
            
            <div class="control-group">
                <label>
                    <input type="checkbox" id="showMoons" checked> Show Moons
                </label>
            </div>
            
            <div class="control-group">
                <label>
                    <input type="checkbox" id="showOrbits" checked> Show Orbits
                </label>
            </div>
            
            <div class="control-group">
                <label>
                    <input type="checkbox" id="showMagnetosphere"> Magnetosphere
                </label>
            </div>
            
            <div class="control-group">
                <label>
                    <input type="checkbox" id="showLabels" checked> Show Labels
                </label>
            </div>
            
            <div class="control-group">
                <label>Distance Scale:</label>
                <input type="range" id="distanceScale" min="0.3" max="2" value="1" step="0.1">
                <span id="distanceValue">1.0x</span>
            </div>
            
            <div class="control-group">
                <label>Moon Size:</label>
                <input type="range" id="moonScale" min="1" max="5" value="2" step="0.5">
                <span id="moonSizeValue">2x</span>
            </div>
            
            <div class="control-group">
                <label>Ring Shine:</label>
                <input type="range" id="ringShine" min="0" max="1" value="0.7" step="0.1">
                <span id="ringShineValue">70%</span>
            </div>
        </div>
    </div>
    
    <!-- Stats Panel -->
    <div id="stats-panel" class="ui-panel">
        <div class="panel-header">
            <div class="panel-title">
                <h3>üìä Stats</h3>
            </div>
            <div class="panel-controls">
                <button class="panel-btn minimize-btn">‚àí</button>
            </div>
        </div>
        <div class="panel-content">
            <div class="stat-line">
                <span>FPS:</span>
                <span id="fps">60</span>
            </div>
            <div class="stat-line">
                <span>Sim Time:</span>
                <span id="simDay">0d</span>
            </div>
            <div class="stat-line">
                <span>Rotation:</span>
                <span id="rotation">0¬∞</span>
            </div>
            <div class="stat-line">
                <span>Year Progress:</span>
                <span id="yearProgress">0%</span>
            </div>
        </div>
    </div>
    
    <!-- Coordinates Panel -->
    <div id="coordinates-panel">
        <div><strong>Camera Position</strong></div>
        <div>X: <span id="camX">0</span></div>
        <div>Y: <span id="camY">0</span></div>
        <div>Z: <span id="camZ">0</span></div>
        <div>Distance: <span id="camDist">0</span></div>
        <div>Azimuth: <span id="camAzimuth">0</span>¬∞</div>
        <div>Elevation: <span id="camElevation">0</span>¬∞</div>
    </div>
    
    <!-- Quick Toggle Buttons -->
    <div class="quick-toggle">
        <button id="quickRings" class="active" title="Toggle Rings">‚≠ï</button>
        <button id="quickMoons" class="active" title="Toggle Moons">üåô</button>
        <button id="quickOrbits" class="active" title="Toggle Orbits">‚ö™</button>
        <button id="quickMag" title="Toggle Magnetosphere">üß≤</button>
        <button id="quickLabels" class="active" title="Toggle Labels">üìù</button>
    </div>
    
    <!-- Moon Info Tooltip -->
    <div id="moon-info">
        <h3 id="moon-name">Moon</h3>
        <p id="moon-details"></p>
        <p id="moon-position"></p>
    </div>
    
    <!-- Help Button -->
    <button id="help-button" title="Help & Tutorial">?</button>
    
    <script>
        // Complete Uranus Simulation - Self-contained
        class UranusSimulation {
            constructor() {
                this.scene = null;
                this.camera = null;
                this.renderer = null;
                this.uranus = null;
                this.rings = [];
                this.moons = [];
                this.moonLabels = [];
                this.orbits = [];
                this.starfield = null;
                this.magnetosphere = null;
                
                // Simulation state
                this.isPaused = false;
                this.timeSpeed = 1;
                this.simulationTime = 0;
                this.rotation = 0;
                
                // Camera controls
                this.isMouseDown = false;
                this.mouseButton = -1;
                this.lastMouseX = 0;
                this.lastMouseY = 0;
                this.cameraDistance = 150;
                this.cameraTheta = 0;
                this.cameraPhi = Math.PI / 3;
                
                // Performance tracking
                this.frameCount = 0;
                this.lastFpsTime = performance.now();
                this.currentFPS = 60;
                
                // Settings
                this.settings = {
                    showRings: true,
                    showMoons: true,
                    showOrbits: true,
                    showMagnetosphere: false,
                    showLabels: true,
                    distanceScale: 1.0,
                    moonScale: 2.0,
                    ringShine: 0.7
                };
                
                // Moon data - all 27 moons of Uranus
                this.moonData = [
                    // Inner moons
                    { name: 'Cordelia', radius: 0.5, distance: 20, period: 8, color: 0x9a8a7a, info: 'Innermost moon, shepherd of Œµ ring' },
                    { name: 'Ophelia', radius: 0.5, distance: 22, period: 9, color: 0x9a8a7a, info: 'Outer shepherd of Œµ ring' },
                    { name: 'Bianca', radius: 0.6, distance: 24, period: 10, color: 0xa59585, info: 'Small inner moon' },
                    { name: 'Cressida', radius: 0.8, distance: 25, period: 11, color: 0xa59585, info: 'Inner moon from Shakespeare' },
                    { name: 'Desdemona', radius: 0.7, distance: 26, period: 11.4, color: 0xa59585, info: 'Named after Othello character' },
                    { name: 'Juliet', radius: 0.9, distance: 27, period: 11.8, color: 0xa59585, info: 'Romeo and Juliet character' },
                    { name: 'Portia', radius: 1.3, distance: 28, period: 12.3, color: 0xa59585, info: 'Largest inner moon' },
                    { name: 'Rosalind', radius: 0.8, distance: 30, period: 13.4, color: 0xa59585, info: 'As You Like It character' },
                    { name: 'Cupid', radius: 0.3, distance: 32, period: 14.7, color: 0x9a8a7a, info: 'Tiny inner moon' },
                    { name: 'Belinda', radius: 0.8, distance: 33, period: 15, color: 0xa59585, info: 'The Rape of the Lock' },
                    { name: 'Perdita', radius: 0.4, distance: 34, period: 15.3, color: 0x9a8a7a, info: 'Lost and found moon' },
                    { name: 'Puck', radius: 1.6, distance: 37, period: 18.3, color: 0xb0a090, info: 'Largest inner moon' },
                    { name: 'Mab', radius: 0.3, distance: 42, period: 22, color: 0x9a8a7a, info: 'Source of Œº ring' },
                    
                    // Major moons
                    { name: 'Miranda', radius: 4, distance: 55, period: 34, color: 0xc8b8a8, info: 'Extreme geological features, 20km cliffs' },
                    { name: 'Ariel', radius: 6, distance: 80, period: 60, color: 0xd4c4b4, info: 'Brightest moon, youngest surface' },
                    { name: 'Umbriel', radius: 6, distance: 110, period: 99, color: 0x7a6a5a, info: 'Darkest major moon' },
                    { name: 'Titania', radius: 8, distance: 185, period: 209, color: 0xb8a898, info: 'Largest moon of Uranus' },
                    { name: 'Oberon', radius: 8, distance: 250, period: 323, color: 0xa89888, info: 'Outermost major moon' },
                    
                    // Irregular moons (distant)
                    { name: 'Francisco', radius: 0.2, distance: 400, period: -600, color: 0x6a5a4a, info: 'Retrograde irregular moon' },
                    { name: 'Caliban', radius: 0.6, distance: 450, period: -800, color: 0x8a6050, info: 'Largest irregular moon' },
                    { name: 'Stephano', radius: 0.3, distance: 500, period: -900, color: 0x6a5a4a, info: 'Retrograde moon' },
                    { name: 'Trinculo', radius: 0.2, distance: 520, period: -950, color: 0x6a5a4a, info: 'High inclination orbit' },
                    { name: 'Sycorax', radius: 0.8, distance: 600, period: -1200, color: 0x9a6050, info: 'Largest known irregular moon' },
                    { name: 'Margaret', radius: 0.2, distance: 650, period: 1300, color: 0x6a5a4a, info: 'Only prograde irregular' },
                    { name: 'Prospero', radius: 0.4, distance: 700, period: -1500, color: 0x7a5a4a, info: 'Distant retrograde' },
                    { name: 'Setebos', radius: 0.4, distance: 750, period: -1600, color: 0x7a5a4a, info: 'Discovered 1999' },
                    { name: 'Ferdinand', radius: 0.2, distance: 800, period: -1800, color: 0x6a5a4a, info: 'Most distant known moon' }
                ];
                
                this.isInitialized = false;
            }
            
            async init() {
                try {
                    console.log('üåå Initializing Uranus Simulation...');
                    
                    this.setupScene();
                    this.createUranus();
                    this.createRings();
                    this.createMoons();
                    this.createStarfield();
                    this.createMagnetosphere();
                    this.setupControls();
                    this.setupUI();
                    
                    // Start animation
                    this.animate();
                    
                    // Hide loading screen
                    setTimeout(() => {
                        document.getElementById('loading').style.display = 'none';
                    }, 2000);
                    
                    this.isInitialized = true;
                    console.log('‚úÖ Uranus Simulation initialized successfully!');
                    
                } catch (error) {
                    console.error('Failed to initialize simulation:', error);
                    this.showError(error.message);
                }
            }
            
            setupScene() {
                // Create scene
                this.scene = new THREE.Scene();
                this.scene.fog = new THREE.FogExp2(0x000822, 0.0002);
                
                // Create camera
                this.camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 10000);
                this.updateCameraPosition();
                
                // Create renderer
                this.renderer = new THREE.WebGLRenderer({ antialias: true });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                this.renderer.toneMapping = THREE.ACESFilmicToneMapping;
                this.renderer.toneMappingExposure = 1.2;
                
                document.getElementById('canvas-container').appendChild(this.renderer.domElement);
                
                // Lighting
                const ambientLight = new THREE.AmbientLight(0x1a1a3a, 0.4);
                this.scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 1.0);
                directionalLight.position.set(200, 100, 200);
                directionalLight.castShadow = true;
                directionalLight.shadow.mapSize.width = 2048;
                directionalLight.shadow.mapSize.height = 2048;
                this.scene.add(directionalLight);
                
                const rimLight = new THREE.PointLight(0x4FD0E7, 0.5, 300);
                rimLight.position.set(-50, 0, -50);
                this.scene.add(rimLight);
            }
            
            createUranus() {
                const geometry = new THREE.SphereGeometry(10, 64, 32);
                
                // Add surface detail
                const positions = geometry.attributes.position;
                const vertex = new THREE.Vector3();
                
                for (let i = 0; i < positions.count; i++) {
                    vertex.fromBufferAttribute(positions, i);
                    const noise = (Math.sin(vertex.y * 3) * 0.02 + Math.cos(vertex.x * 5) * 0.01) * 0.1;
                    vertex.normalize();
                    vertex.multiplyScalar(10 + noise);
                    positions.setXYZ(i, vertex.x, vertex.y, vertex.z);
                }
                
                positions.needsUpdate = true;
                geometry.computeVertexNormals();
                
                const material = new THREE.MeshPhongMaterial({
                    color: 0x4FD0E7,
                    emissive: 0x0a2a3a,
                    emissiveIntensity: 0.1,
                    specular: 0x6FE5F5,
                    shininess: 40,
                    reflectivity: 0.3
                });
                
                this.uranus = new THREE.Mesh(geometry, material);
                this.uranus.castShadow = true;
                this.uranus.receiveShadow = true;
                this.uranus.rotation.z = 97.77 * Math.PI / 180; // Extreme axial tilt
                this.scene.add(this.uranus);
                
                // Atmosphere glow
                const glowGeometry = new THREE.SphereGeometry(12, 32, 16);
                const glowMaterial = new THREE.ShaderMaterial({
                    uniforms: {
                        glowColor: { value: new THREE.Color(0x4FD0E7) }
                    },
                    vertexShader: `
                        varying float intensity;
                        void main() {
                            vec3 vNormal = normalize(normalMatrix * normal);
                            intensity = pow(0.7 - dot(vNormal, vec3(0, 0, 1.0)), 2.0);
                            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                        }
                    `,
                    fragmentShader: `
                        uniform vec3 glowColor;
                        varying float intensity;
                        void main() {
                            vec3 glow = glowColor * intensity;
                            gl_FragColor = vec4(glow, intensity * 0.1);
                        }
                    `,
                    side: THREE.BackSide,
                    blending: THREE.AdditiveBlending,
                    transparent: true
                });
                
                const glow = new THREE.Mesh(glowGeometry, glowMaterial);
                glow.rotation.z = 97.77 * Math.PI / 180;
                this.scene.add(glow);
            }
            
            createRings() {
                // Ring system data
                const ringsData = [
                    { name: 'Œ∂', inner: 15, outer: 16, opacity: 0.4 },
                    { name: '6', inner: 17, outer: 17.2, opacity: 0.6 },
                    { name: '5', inner: 17.5, outer: 17.7, opacity: 0.6 },
                    { name: '4', inner: 18, outer: 18.2, opacity: 0.6 },
                    { name: 'Œ±', inner: 18.8, outer: 19, opacity: 0.8 },
                    { name: 'Œ≤', inner: 19.5, outer: 19.7, opacity: 0.8 },
                    { name: 'Œ∑', inner: 20, outer: 20.1, opacity: 0.5 },
                    { name: 'Œ≥', inner: 20.2, outer: 20.3, opacity: 0.7 },
                    { name: 'Œ¥', inner: 20.5, outer: 20.7, opacity: 0.7 },
                    { name: 'Œª', inner: 21, outer: 21.1, opacity: 0.4 },
                    { name: 'Œµ', inner: 21.5, outer: 22, opacity: 1.0 }, // Main ring
                    { name: 'ŒΩ', inner: 28, outer: 30, opacity: 0.2 },
                    { name: 'Œº', inner: 36, outer: 43, opacity: 0.15 }
                ];
                
                ringsData.forEach(ringData => {
                    const geometry = new THREE.RingGeometry(ringData.inner, ringData.outer, 128, 1);
                    
                    let color = 0x808890;
                    if (ringData.name === 'Œµ') color = 0xb0c0d0;
                    else if (ringData.name === 'Œº' || ringData.name === 'ŒΩ') color = 0x7a9aba;
                    
                    const material = new THREE.MeshBasicMaterial({
                        color: color,
                        transparent: true,
                        opacity: ringData.opacity * 0.8,
                        side: THREE.DoubleSide,
                        depthWrite: false
                    });
                    
                    const ring = new THREE.Mesh(geometry, material);
                    ring.rotation.x = -Math.PI / 2;
                    ring.rotation.z = 97.77 * Math.PI / 180; // Match Uranus tilt
                    ring.userData = { name: ringData.name, baseOpacity: ringData.opacity };
                    
                    this.rings.push(ring);
                    this.scene.add(ring);
                });
            }
            
            createMoons() {
                this.moonData.forEach((moonData, index) => {
                    // Create moon
                    const geometry = new THREE.SphereGeometry(moonData.radius, 16, 8);
                    const material = new THREE.MeshPhongMaterial({
                        color: moonData.color,
                        emissive: moonData.color,
                        emissiveIntensity: 0.05
                    });
                    
                    const moon = new THREE.Mesh(geometry, material);
                    moon.name = moonData.name;
                    moon.userData = { ...moonData, angle: Math.random() * Math.PI * 2, index };
                    
                    // Set initial position
                    const distance = moonData.distance * this.settings.distanceScale;
                    moon.position.x = Math.cos(moon.userData.angle) * distance;
                    moon.position.z = Math.sin(moon.userData.angle) * distance;
                    
                    if (moonData.radius >= 4) { // Major moons
                        moon.castShadow = true;
                        moon.receiveShadow = true;
                    }
                    
                    this.moons.push(moon);
                    this.scene.add(moon);
                    
                    // Create orbit line
                    const orbitGeometry = new THREE.RingGeometry(distance - 0.5, distance + 0.5, 64, 1);
                    const orbitColor = moonData.radius >= 4 ? 0x6fa5c5 : 0x4080a0;
                    const orbitMaterial = new THREE.MeshBasicMaterial({
                        color: orbitColor,
                        transparent: true,
                        opacity: 0.3,
                        side: THREE.DoubleSide
                    });
                    
                    const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
                    orbit.rotation.x = -Math.PI / 2;
                    orbit.userData = { moonName: moonData.name };
                    
                    this.orbits.push(orbit);
                    this.scene.add(orbit);
                    
                    // Create label for major moons
                    if (moonData.radius >= 4) {
                        const canvas = document.createElement('canvas');
                        canvas.width = 256;
                        canvas.height = 64;
                        const ctx = canvas.getContext('2d');
                        
                        ctx.font = 'Bold 20px Arial';
                        ctx.fillStyle = 'rgba(111, 229, 245, 0.9)';
                        ctx.fillText(moonData.name, 10, 35);
                        
                        const texture = new THREE.CanvasTexture(canvas);
                        const labelMaterial = new THREE.SpriteMaterial({
                            map: texture,
                            transparent: true,
                            depthTest: false
                        });
                        
                        const label = new THREE.Sprite(labelMaterial);
                        label.scale.set(8, 2, 1);
                        label.position.copy(moon.position);
                        label.position.y += moonData.radius + 2;
                        label.userData = { moonName: moonData.name };
                        
                        this.moonLabels.push(label);
                        this.scene.add(label);
                    }
                });
            }
            
            createStarfield() {
                const geometry = new THREE.BufferGeometry();
                const positions = [];
                const colors = [];
                const sizes = [];
                
                for (let i = 0; i < 10000; i++) {
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.acos(Math.random() * 2 - 1);
                    const r = 2000 + Math.random() * 1000;
                    
                    positions.push(
                        r * Math.sin(phi) * Math.cos(theta),
                        r * Math.sin(phi) * Math.sin(theta),
                        r * Math.cos(phi)
                    );
                    
                    // Star colors
                    const colorVar = Math.random();
                    if (colorVar < 0.7) {
                        colors.push(1, 1, 1); // White
                    } else if (colorVar < 0.85) {
                        colors.push(0.8, 0.8, 1); // Blue
                    } else {
                        colors.push(1, 0.8, 0.6); // Orange
                    }
                    
                    sizes.push(0.5 + Math.random() * 1.5);
                }
                
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
                geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
                geometry.setAttribute('size', new THREE.Float32BufferAttribute(sizes, 1));
                
                const material = new THREE.PointsMaterial({
                    size: 2,
                    vertexColors: true,
                    transparent: true,
                    opacity: 0.8,
                    blending: THREE.AdditiveBlending
                });
                
                this.starfield = new THREE.Points(geometry, material);
                this.scene.add(this.starfield);
            }
            
            createMagnetosphere() {
                const group = new THREE.Group();
                
                // Field lines
                for (let i = 0; i < 6; i++) {
                    const torusGeometry = new THREE.TorusGeometry(25 + i * 5, 0.2, 8, 50);
                    const torusMaterial = new THREE.MeshBasicMaterial({
                        color: 0xff6b9d,
                        transparent: true,
                        opacity: 0.15,
                        wireframe: true,
                        blending: THREE.AdditiveBlending
                    });
                    
                    const torus = new THREE.Mesh(torusGeometry, torusMaterial);
                    torus.rotation.x = Math.PI / 2;
                    torus.rotation.z = i * 0.2;
                    group.add(torus);
                }
                
                // Offset and tilt magnetosphere
                group.position.y = -3; // Offset from planet center
                group.rotation.x = 58.6 * Math.PI / 180; // Magnetic field tilt
                group.rotation.z = 97.77 * Math.PI / 180; // Match Uranus tilt
                group.visible = false;
                
                this.magnetosphere = group;
                this.scene.add(group);
            }
            
            setupControls() {
                const canvas = this.renderer.domElement;
                
                // Mouse events
                canvas.addEventListener('mousedown', (e) => {
                    this.isMouseDown = true;
                    this.mouseButton = e.button;
                    this.lastMouseX = e.clientX;
                    this.lastMouseY = e.clientY;
                    canvas.style.cursor = 'grabbing';
                });
                
                document.addEventListener('mouseup', () => {
                    this.isMouseDown = false;
                    this.mouseButton = -1;
                    canvas.style.cursor = 'grab';
                });
                
                document.addEventListener('mousemove', (e) => {
                    if (!this.isMouseDown) return;
                    
                    const deltaX = e.clientX - this.lastMouseX;
                    const deltaY = e.clientY - this.lastMouseY;
                    
                    if (this.mouseButton === 0) { // Left button - rotate
                        this.cameraTheta -= deltaX * 0.01;
                        this.cameraPhi = Math.max(0.1, Math.min(Math.PI - 0.1, this.cameraPhi + deltaY * 0.01));
                        this.updateCameraPosition();
                    } else if (this.mouseButton === 2) { // Right button - pan
                        // Simple pan implementation
                        const factor = this.cameraDistance * 0.001;
                        this.camera.position.x += deltaX * factor;
                        this.camera.position.y -= deltaY * factor;
                    }
                    
                    this.lastMouseX = e.clientX;
                    this.lastMouseY = e.clientY;
                });
                
                // Wheel zoom
                canvas.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const scale = e.deltaY > 0 ? 1.1 : 0.9;
                    this.cameraDistance = Math.max(30, Math.min(500, this.cameraDistance * scale));
                    this.updateCameraPosition();
                });
                
                // Prevent context menu
                canvas.addEventListener('contextmenu', (e) => e.preventDefault());
                
                // Touch controls for mobile
                let touchDistance = 0;
                canvas.addEventListener('touchstart', (e) => {
                    if (e.touches.length === 2) {
                        const dx = e.touches[0].clientX - e.touches[1].clientX;
                        const dy = e.touches[0].clientY - e.touches[1].clientY;
                        touchDistance = Math.sqrt(dx * dx + dy * dy);
                    }
                });
                
                canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    if (e.touches.length === 2) {
                        const dx = e.touches[0].clientX - e.touches[1].clientX;
                        const dy = e.touches[0].clientY - e.touches[1].clientY;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        const scale = touchDistance / distance;
                        this.cameraDistance = Math.max(30, Math.min(500, this.cameraDistance * scale));
                        touchDistance = distance;
                        this.updateCameraPosition();
                    }
                });
                
                // Window resize
                window.addEventListener('resize', () => {
                    this.camera.aspect = window.innerWidth / window.innerHeight;
                    this.camera.updateProjectionMatrix();
                    this.renderer.setSize(window.innerWidth, window.innerHeight);
                });
            }
            
            setupUI() {
                // Panel minimize buttons
                document.querySelectorAll('.minimize-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const panel = btn.closest('.ui-panel');
                        const isMinimized = panel.classList.toggle('minimized');
                        btn.textContent = isMinimized ? '+' : '‚àí';
                    });
                });
                
                // Time speed slider
                const timeSpeedSlider = document.getElementById('timeSpeed');
                timeSpeedSlider.addEventListener('input', (e) => {
                    const value = parseFloat(e.target.value);
                    if (value < 0) {
                        this.timeSpeed = Math.pow(10, value);
                    } else {
                        this.timeSpeed = Math.pow(10, value);
                    }
                    
                    let displayText;
                    if (this.timeSpeed < 1) {
                        displayText = `${(this.timeSpeed * 3600).toFixed(1)} sec/sec`;
                    } else {
                        displayText = `${this.timeSpeed.toFixed(1)} hours/sec`;
                    }
                    document.getElementById('timeSpeedValue').textContent = displayText;
                });
                
                // Control buttons
                document.getElementById('pauseBtn').addEventListener('click', () => {
                    this.isPaused = !this.isPaused;
                    document.getElementById('pauseBtn').textContent = this.isPaused ? '‚ñ∂ Play' : '‚è∏ Pause';
                });
                
                document.getElementById('resetBtn').addEventListener('click', () => {
                    this.cameraDistance = 150;
                    this.cameraTheta = 0;
                    this.cameraPhi = Math.PI / 3;
                    this.updateCameraPosition();
                });
                
                // Display toggles
                const toggles = [
                    { id: 'showRings', property: 'showRings', objects: this.rings },
                    { id: 'showMoons', property: 'showMoons', objects: this.moons },
                    { id: 'showOrbits', property: 'showOrbits', objects: this.orbits },
                    { id: 'showLabels', property: 'showLabels', objects: this.moonLabels }
                ];
                
                toggles.forEach(({ id, property, objects }) => {
                    const checkbox = document.getElementById(id);
                    checkbox.addEventListener('change', (e) => {
                        this.settings[property] = e.target.checked;
                        objects.forEach(obj => obj.visible = e.target.checked);
                        
                        // Update quick toggle
                        const quickBtn = document.getElementById('quick' + property.replace('show', ''));
                        if (quickBtn) {
                            quickBtn.classList.toggle('active', e.target.checked);
                        }
                    });
                });
                
                // Magnetosphere toggle
                document.getElementById('showMagnetosphere').addEventListener('change', (e) => {
                    this.settings.showMagnetosphere = e.target.checked;
                    if (this.magnetosphere) {
                        this.magnetosphere.visible = e.target.checked;
                    }
                });
                
                // Scale sliders
                document.getElementById('distanceScale').addEventListener('input', (e) => {
                    this.settings.distanceScale = parseFloat(e.target.value);
                    document.getElementById('distanceValue').textContent = this.settings.distanceScale.toFixed(1) + 'x';
                    this.updateMoonPositions();
                });
                
                document.getElementById('moonScale').addEventListener('input', (e) => {
                    this.settings.moonScale = parseFloat(e.target.value);
                    document.getElementById('moonSizeValue').textContent = this.settings.moonScale + 'x';
                    this.moons.forEach(moon => {
                        moon.scale.setScalar(this.settings.moonScale);
                    });
                });
                
                document.getElementById('ringShine').addEventListener('input', (e) => {
                    this.settings.ringShine = parseFloat(e.target.value);
                    document.getElementById('ringShineValue').textContent = Math.round(this.settings.ringShine * 100) + '%';
                    this.rings.forEach(ring => {
                        ring.material.opacity = ring.userData.baseOpacity * this.settings.ringShine;
                    });
                });
                
                // Quick toggle buttons
                document.getElementById('quickRings').addEventListener('click', () => {
                    document.getElementById('showRings').click();
                });
                
                document.getElementById('quickMoons').addEventListener('click', () => {
                    document.getElementById('showMoons').click();
                });
                
                document.getElementById('quickOrbits').addEventListener('click', () => {
                    document.getElementById('showOrbits').click();
                });
                
                document.getElementById('quickMag').addEventListener('click', () => {
                    document.getElementById('showMagnetosphere').click();
                });
                
                document.getElementById('quickLabels').addEventListener('click', () => {
                    document.getElementById('showLabels').click();
                });
                
                // Help button
                document.getElementById('help-button').addEventListener('click', () => {
                    this.showMessage(`üåå URANUS SIMULATION HELP üåå
                    
CAMERA CONTROLS:
‚Ä¢ Left Click + Drag: Rotate view
‚Ä¢ Scroll Wheel: Zoom in/out
‚Ä¢ Right Click + Drag: Pan view

FEATURES:
‚Ä¢ 27 Moons: All known moons of Uranus
‚Ä¢ 13 Rings: Including the bright Œµ ring
‚Ä¢ Time Control: Speed up or slow down
‚Ä¢ Toggles: Show/hide different components

SCIENTIFIC ACCURACY:
‚Ä¢ Realistic orbital mechanics
‚Ä¢ Proper moon sizes and distances
‚Ä¢ Authentic ring system
‚Ä¢ 97.77¬∞ axial tilt (sideways planet!)

Enjoy exploring the Uranus system! ü™ê`);
                });
                
                // Raycasting for moon hover
                this.raycaster = new THREE.Raycaster();
                this.mouse = new THREE.Vector2();
                
                this.renderer.domElement.addEventListener('mousemove', (e) => {
                    if (this.isMouseDown) return;
                    
                    const rect = this.renderer.domElement.getBoundingClientRect();
                    this.mouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
                    this.mouse.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
                    
                    this.raycaster.setFromCamera(this.mouse, this.camera);
                    const intersects = this.raycaster.intersectObjects(this.moons);
                    
                    const moonInfo = document.getElementById('moon-info');
                    
                    if (intersects.length > 0) {
                        const moon = intersects[0].object;
                        const data = moon.userData;
                        
                        document.getElementById('moon-name').textContent = data.name;
                        document.getElementById('moon-details').textContent = data.info;
                        document.getElementById('moon-position').textContent = 
                            `Distance: ${data.distance} RU | Period: ${Math.abs(data.period)} hours`;
                        
                        moonInfo.classList.add('visible');
                        this.renderer.domElement.style.cursor = 'pointer';
                        
                        // Highlight moon
                        moon.material.emissiveIntensity = 0.3;
                    } else {
                        moonInfo.classList.remove('visible');
                        this.renderer.domElement.style.cursor = 'grab';
                        
                        // Remove highlights
                        this.moons.forEach(moon => {
                            moon.material.emissiveIntensity = 0.05;
                        });
                    }
                });
            }
            
            updateCameraPosition() {
                const x = this.cameraDistance * Math.sin(this.cameraPhi) * Math.cos(this.cameraTheta);
                const y = this.cameraDistance * Math.cos(this.cameraPhi);
                const z = this.cameraDistance * Math.sin(this.cameraPhi) * Math.sin(this.cameraTheta);
                
                this.camera.position.set(x, y, z);
                this.camera.lookAt(0, 0, 0);
            }
            
            updateMoonPositions() {
                this.moons.forEach((moon, index) => {
                    const data = moon.userData;
                    const distance = data.distance * this.settings.distanceScale;
                    moon.position.x = Math.cos(data.angle) * distance;
                    moon.position.z = Math.sin(data.angle) * distance;
                    
                    // Update orbit
                    const orbit = this.orbits[index];
                    if (orbit) {
                        orbit.geometry.dispose();
                        orbit.geometry = new THREE.RingGeometry(distance - 0.5, distance + 0.5, 64, 1);
                    }
                    
                    // Update label position
                    const label = this.moonLabels.find(l => l.userData.moonName === data.name);
                    if (label) {
                        label.position.copy(moon.position);
                        label.position.y += data.radius * this.settings.moonScale + 2;
                    }
                });
            }
            
            animate() {
                requestAnimationFrame(() => this.animate());
                
                const currentTime = performance.now();
                const deltaTime = (currentTime - (this.lastTime || currentTime)) / 1000;
                this.lastTime = currentTime;
                
                if (!this.isPaused) {
                    this.simulationTime += deltaTime * this.timeSpeed;
                    
                    // Rotate Uranus
                    this.rotation += deltaTime * this.timeSpeed * 0.1;
                    if (this.uranus) {
                        this.uranus.rotation.y = -this.rotation; // Retrograde
                    }
                    
                    // Move moons
                    this.moons.forEach(moon => {
                        const data = moon.userData;
                        const period = Math.abs(data.period);
                        const speed = (2 * Math.PI) / (period * 3600); // Convert hours to seconds
                        
                        if (data.period < 0) {
                            data.angle -= speed * deltaTime * this.timeSpeed; // Retrograde
                        } else {
                            data.angle += speed * deltaTime * this.timeSpeed; // Prograde
                        }
                        
                        const distance = data.distance * this.settings.distanceScale;
                        moon.position.x = Math.cos(data.angle) * distance;
                        moon.position.z = Math.sin(data.angle) * distance;
                        
                        // Tidal locking - moon faces Uranus
                        moon.lookAt(0, moon.position.y, 0);
                        
                        // Update label position
                        const label = this.moonLabels.find(l => l.userData.moonName === data.name);
                        if (label) {
                            label.position.copy(moon.position);
                            label.position.y += data.radius * this.settings.moonScale + 2;
                        }
                    });
                    
                    // Rotate rings slowly
                    this.rings.forEach(ring => {
                        ring.rotation.y += deltaTime * this.timeSpeed * 0.001;
                    });
                    
                    // Animate magnetosphere
                    if (this.magnetosphere) {
                        this.magnetosphere.rotation.y += deltaTime * 0.01;
                    }
                }
                
                // Update UI stats
                this.updateStats();
                
                // Render scene
                this.renderer.render(this.scene, this.camera);
                
                // Update FPS
                this.frameCount++;
                if (currentTime - this.lastFpsTime > 1000) {
                    this.currentFPS = Math.round(this.frameCount * 1000 / (currentTime - this.lastFpsTime));
                    this.frameCount = 0;
                    this.lastFpsTime = currentTime;
                }
            }
            
            updateStats() {
                // FPS
                document.getElementById('fps').textContent = this.currentFPS;
                
                // Simulation time
                const hours = this.simulationTime / 3600;
                if (hours < 24) {
                    document.getElementById('simDay').textContent = hours.toFixed(1) + 'h';
                } else {
                    const days = hours / 24;
                    document.getElementById('simDay').textContent = days.toFixed(1) + 'd';
                }
                
                // Rotation
                const degrees = ((-this.rotation * 180 / Math.PI) % 360 + 360) % 360;
                document.getElementById('rotation').textContent = degrees.toFixed(0) + '¬∞';
                
                // Year progress
                const yearHours = 84 * 365.25 * 24;
                const yearProgress = (this.simulationTime / yearHours * 100) % 100;
                document.getElementById('yearProgress').textContent = yearProgress.toFixed(2) + '%';
                
                // Camera info
                document.getElementById('camX').textContent = this.camera.position.x.toFixed(1);
                document.getElementById('camY').textContent = this.camera.position.y.toFixed(1);
                document.getElementById('camZ').textContent = this.camera.position.z.toFixed(1);
                document.getElementById('camDist').textContent = this.cameraDistance.toFixed(1);
                document.getElementById('camAzimuth').textContent = (this.cameraTheta * 180 / Math.PI).toFixed(1);
                document.getElementById('camElevation').textContent = ((Math.PI/2 - this.cameraPhi) * 180 / Math.PI).toFixed(1);
            }
            
            showMessage(text) {
                const msg = document.createElement('div');
                msg.className = 'message';
                msg.style.whiteSpace = 'pre-line';
                msg.textContent = text;
                
                document.body.appendChild(msg);
                
                setTimeout(() => {
                    msg.style.opacity = '0';
                    msg.style.transform = 'translateX(-50%) translateY(-20px)';
                    setTimeout(() => msg.remove(), 300);
                }, 4000);
            }
            
            showError(message) {
                document.getElementById('loading').innerHTML = `
                    <div style="color: #ff6b6b; text-align: center;">
                        <div>‚ö†Ô∏è Error</div>
                        <div style="font-size: 16px; margin-top: 10px;">${message}</div>
                        <button class="control-button" onclick="location.reload()" style="margin-top: 20px;">
                            Reload Page
                        </button>
                    </div>
                `;
            }
        }
        
        // Initialize simulation when page loads
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Starting Uranus Simulation...');
            
            // Check if Three.js loaded
            if (typeof THREE === 'undefined') {
                console.error('Three.js failed to load');
                document.getElementById('loading').innerHTML = `
                    <div style="color: #ff6b6b; text-align: center;">
                        <div>‚ö†Ô∏è Three.js Library Failed to Load</div>
                        <div style="font-size: 14px; margin-top: 10px;">
                            Check your internet connection and reload the page
                        </div>
                        <button class="control-button" onclick="location.reload()" style="margin-top: 20px;">
                            Reload Page
                        </button>
                    </div>
                `;
                return;
            }
            
            try {
                const simulation = new UranusSimulation();
                await simulation.init();
                
                // Export to global scope for debugging
                window.UranusSimulation = simulation;
                
            } catch (error) {
                console.error('Failed to initialize simulation:', error);
                document.getElementById('loading').innerHTML = `
                    <div style="color: #ff6b6b; text-align: center;">
                        <div>‚ö†Ô∏è Initialization Failed</div>
                        <div style="font-size: 14px; margin-top: 10px;">${error.message}</div>
                        <button class="control-button" onclick="location.reload()" style="margin-top: 20px;">
                            Try Again
                        </button>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
